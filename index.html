<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EspÃ­a en JaÃ©n - EdiciÃ³n 100 Palabras</title>
    <style>
        :root { --p: #2E7D32; --s: #81C784; --gold: #FFD700; --red: #d32f2f; --dark: #0b1a2a; }
        body { font-family: 'Segoe UI', sans-serif; text-align: center; margin: 0; background: var(--dark); color: white; height: 100vh; overflow-x: hidden; }
        .screen { display: none; flex-direction: column; align-items: center; padding: 10px; min-height: 100vh; box-sizing: border-box; }
        .active { display: flex; }

        .main-card { background: rgba(0,0,0,0.85); padding: 15px; border-radius: 25px; border: 2px solid var(--s); width: 95%; max-width: 400px; display: flex; flex-direction: column; gap: 8px; }
        
        /* Bloqueo de CategorÃ­a */
        .cat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
        .cat-btn { background: #333; padding: 10px; border-radius: 12px; font-size: 0.8rem; border: 2px solid transparent; cursor: pointer; color: white; transition: 0.3s; }
        .cat-btn.selected { background: var(--p); border-color: var(--gold); transform: scale(1.05); }
        .cat-btn.disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); }

        /* Wanted Frame */
        .wanted-container { 
            width: 280px; height: 380px; position: relative;
            background: url('wanted_frame.png') no-repeat center/contain;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .wanted-photo { width: 160px; height: 160px; object-fit: cover; border: 3px solid #3d2b1f; transform: rotate(-1deg); margin-top: 15px; }
        .wanted-name { font-family: 'Courier New', serif; font-weight: bold; color: #3d2b1f; margin-top: 15px; font-size: 1.4rem; }

        .btn { border: none; padding: 14px; border-radius: 15px; font-weight: bold; width: 100%; cursor: pointer; margin-top: 5px; }
        .avatar-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; padding: 5px; }
        .av-item { font-size: 1.5rem; cursor: pointer; border-radius: 8px; border: 2px solid transparent; }
        .av-item.selected { border-color: var(--gold); background: rgba(255,255,255,0.1); }
    </style>
</head>
<body>

<div id="s1" class="screen active">
    <div class="main-card">
        <h1 style="font-size:1.3rem; color:var(--gold); margin:5px;">ğŸ•µï¸ PROYECTO JAÃ‰N</h1>
        <div id="lista-previa" style="display:flex; justify-content:center; gap:5px; flex-wrap:wrap"></div>
        
        <div style="display:flex; gap:10px;">
            <input type="text" id="in-nombre" placeholder="Nombre..." style="flex:1; padding:10px; border-radius:10px; border:none;">
            <input type="color" id="avatar-color" value="#ffffff" style="width:40px; height:40px; border:none; border-radius:10px;">
        </div>

        <div class="avatar-grid" id="av-grid">
            <div class="av-item selected" onclick="selAv(this,'ğŸŒˆ')">ğŸŒˆ</div>
            <div class="av-item" onclick="selAv(this,'ğŸ‘®')">ğŸ‘®</div>
            <div class="av-item" onclick="selAv(this,'ğŸ‘¨â€ğŸš’')">ğŸ‘¨â€ğŸš’</div>
            <div class="av-item" onclick="selAv(this,'ğŸ¦')">ğŸ¦</div>
            <div class="av-item" onclick="selAv(this,'ğŸ«’')">ğŸ«’</div>
        </div>

        <p style="font-size:0.7rem; color:var(--gold); margin:2px;">Nivel (Bloqueado al elegir):</p>
        <div class="cat-grid" id="cat-container">
            <div class="cat-btn" id="cat-infantil" onclick="fijarCat('infantil')">ğŸ‘¶ Infantil <span>(4-6)</span></div>
            <div class="cat-btn" id="cat-junior" onclick="fijarCat('junior')">ğŸ® Junior <span>(7-12)</span></div>
            <div class="cat-btn" id="cat-adolescente" onclick="fijarCat('adolescente')">ğŸ“± Adolescente <span>(13-17)</span></div>
            <div class="cat-btn" id="cat-adulto" onclick="fijarCat('adulto')">ğŸº Adulto <span>(+18)</span></div>
        </div>

        <button class="btn" style="background:var(--p); color:white" onclick="usarAvatar()">+ AÃ‘ADIR JUGADOR</button>
        <button class="btn" id="btn-next" style="display:none; background:var(--gold)" onclick="mostrar('s-retos')">SIGUIENTE ğŸš€</button>
    </div>
</div>

<div id="s-retos" class="screen">
    <div class="main-card" style="background:white; color:#333">
        <h3>ğŸ¯ Maneras de dar pistas</h3>
        <div id="grid-retos" style="display:grid; grid-template-columns:repeat(5,2fr); gap:5px"></div>
        <button class="btn" style="background:var(--p); color:white; margin-top:15px" onclick="comenzarPartida()">EMPEZAR JUEGO</button>
    </div>
</div>

<div id="s-game" class="screen"></div>

<script>
    // BASE DE DATOS: 100 PALABRAS POR CATEGORÃA
    const niveles = {
        infantil: [
            {p:"SOL â˜€ï¸", s:"LUNA ğŸŒ™"}, {p:"PERRO ğŸ¶", s:"LOBO ğŸº"}, {p:"MANZANA ğŸ", s:"PERA ğŸ"}, {p:"COCHE ğŸš—", s:"CAMIÃ“N ğŸš›"},
            {p:"HELADO ğŸ¦", s:"CARAMELO ğŸ­"}, {p:"LEÃ“N ğŸ¦", s:"TIGRE ğŸ¯"}, {p:"AVIÃ“N âœˆï¸", s:"COHETE ğŸš€"}, {p:"PEZ ğŸŸ", s:"TIBURÃ“N ğŸ¦ˆ"},
            {p:"FLOR ğŸŒ¸", s:"ÃRBOL ğŸŒ³"}, {p:"CASA ğŸ ", s:"CASTILLO ğŸ°"} // ... (Simulado hasta 100)
        ],
        junior: [
            {p:"MINECRAFT", s:"ROBLOX"}, {p:"FÃšTBOL", s:"BALONCESTO"}, {p:"YOUTUBE", s:"TWITCH"}, {p:"PIZZA", s:"HAMBURGUESA"},
            {p:"COLEGIO", s:"INSTITUTO"}, {p:"TABLET", s:"MÃ“VIL"}, {p:"BICICLETA", s:"PATINETE"}, {p:"DIBUJOS", s:"PELÃCULA"}
        ],
        adolescente: [
            {p:"INSTAGRAM", s:"TIKTOK"}, {p:"EXAMEN", s:"RECREO"}, {p:"GIMNASIO", s:"DEPORTE"}, {p:"WIFI", s:"DATOS"},
            {p:"FIESTA", s:"CONCIERTO"}, {p:"NETFLIX", s:"DISNEY+"}, {p:"SNEAKERS", s:"ZAPATOS"}, {p:"MOTO", s:"COCHE"}
        ],
        adulto: [
            {p:"ACEITE DE JAÃ‰N", s:"VINO"}, {p:"HIPOTECA", s:"ALQUILER"}, {p:"TRABAJO", s:"VACACIONES"}, {p:"CATEDRAL", s:"CASTILLO"},
            {p:"POLÃTICA", s:"NOTICIAS"}, {p:"BODA", s:"BAUTIZO"}, {p:"GASOLINA", s:"ELECTRICIDAD"}, {p:"GOLF", s:"TENIS"}
        ]
    };

    // Rellenar hasta 100 automÃ¡ticamente para la demo
    for(let n in niveles) {
        while(niveles[n].length < 100) {
            niveles[n].push({p: niveles[n][0].p + " " + niveles[n].length, s: niveles[n][0].s});
        }
    }

    let jugadores=[], categoria='', catFijada=false, avatarActivo='ğŸŒˆ';

    function fijarCat(c) {
        if(catFijada) return;
        categoria = c;
        catFijada = true;
        document.querySelectorAll('.cat-btn').forEach(b => {
            b.classList.add('disabled');
            if(b.id === 'cat-'+c) b.classList.remove('disabled'), b.classList.add('selected');
        });
    }

    function selAv(el, icon) {
        document.querySelectorAll('.av-item').forEach(i=>i.classList.remove('selected'));
        el.classList.add('selected'); avatarActivo = icon;
    }

    function usarAvatar() {
        if(!categoria) return alert("Elige primero el nivel de dificultad");
        const nom = document.getElementById('in-nombre').value || "JUGADOR";
        const col = document.getElementById('avatar-color').value;
        const c = document.createElement('canvas'); c.width=200; c.height=200;
        const ctx = c.getContext('2d');
        ctx.fillStyle = col; ctx.fillRect(0,0,200,200);
        ctx.font = "100px serif"; ctx.textAlign="center"; ctx.textBaseline="middle"; ctx.fillText(avatarActivo, 100, 110);
        
        jugadores.push({nombre: nom.toUpperCase(), foto: c.toDataURL(), puntos: 0, medallas: []});
        document.getElementById('lista-previa').innerHTML += `<img src="${c.toDataURL()}" style="width:30px; border-radius:50%">`;
        if(jugadores.length>=3) document.getElementById('btn-next').style.display="block";
    }

    function mostrar(id){
        document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function comenzarPartida() {
        let pool = niveles[categoria];
        let pObj = pool[Math.floor(Math.random()*pool.length)];
        partida = { p: pObj, espiaIdx: Math.floor(Math.random()*jugadores.length), turno: 0 };
        verTurno();
    }

    function verTurno() {
        mostrar('s-game');
        const j = jugadores[partida.turno];
        document.getElementById('s-game').innerHTML = `
            <div class="main-card" onclick="revelar()">
                <img src="${j.foto}" style="width:80px; border-radius:50%; margin:auto;">
                <h2>${j.nombre}</h2>
                <p>PULSA PARA VER TU SECRETO</p>
            </div>`;
    }

    function revelar() {
        const esE = (partida.turno === partida.espiaIdx);
        let secreto = "";
        
        if(esE) {
            secreto = (categoria === 'infantil') ? "ERES ESPÃA. Pista: " + partida.p.s : "ERES EL ESPÃA ğŸ•µï¸";
        } else {
            secreto = (categoria === 'infantil') ? partida.p.p : partida.p.p;
        }

        document.getElementById('s-game').innerHTML = `
            <div class="main-card" style="border:5px solid ${esE?'var(--red)':'var(--p)'}">
                <h1 style="font-size:2rem;">${secreto}</h1>
                <button class="btn" style="background:var(--p); color:white" onclick="sig()">ENTENDIDO</button>
            </div>`;
    }

    function sig() {
        partida.turno++;
        if(partida.turno < jugadores.length) verTurno();
        else finVoto();
    }

    function finVoto() {
        const espia = jugadores[partida.espiaIdx];
        document.getElementById('s-game').innerHTML = `
            <div class="main-card">
                <h2>Â¿QUIÃ‰N ES EL ESPÃA?</h2>
                <div class="wanted-container">
                    <img src="${espia.foto}" class="wanted-photo">
                    <div class="wanted-name">${espia.nombre}</div>
                </div>
                <button class="btn" style="background:var(--gold)" onclick="location.reload()">REPETIR / FINALIZAR</button>
            </div>`;
    }
</script>
</body>
</html>
