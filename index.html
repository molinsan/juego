<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Podio de Ja√©n - Proyecto Ciudades de Andaluc√≠a</title>
    <style>
        :root { 
            --gold-grad: linear-gradient(180deg, #FFD700 0%, #B8860B 100%);
            --dark-blue: #0f172a; --card-bg: rgba(255, 255, 255, 0.1);
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--dark-blue); color: white; margin: 0; text-align: center; }
        .screen { display: none; flex-direction: column; align-items: center; min-height: 100vh; padding: 20px; box-sizing: border-box; }
        .active { display: flex; }

        /* ESTILO PODIO IMAGEN */
        .podio-container {
            background: rgba(255,255,255,0.05);
            border: 3px solid #B8860B;
            border-radius: 40px;
            padding: 40px 20px;
            position: relative;
            width: 95%;
            max-width: 900px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .gold-card {
            background: var(--card-bg);
            border: 2px solid #FFD700;
            border-radius: 20px;
            width: 160px;
            padding: 10px;
            position: relative;
            overflow: visible;
        }

        .photo-frame {
            width: 100%;
            height: 160px;
            background: white;
            border-radius: 10px;
            object-fit: cover;
        }

        .name-banner {
            background: var(--gold-grad);
            color: black;
            font-weight: bold;
            padding: 5px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 1.1rem;
        }

        .points-box { color: #FFD700; font-weight: bold; margin: 5px 0; }

        .town-tags { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
        .tag { background: rgba(255,255,255,0.2); border-radius: 5px; font-size: 0.65rem; padding: 3px; }

        /* DECORACI√ìN */
        .rainbow-decor { position: absolute; top: -40px; left: 50%; width: 80px; transform: translateX(-50%); z-index: 5; }
        .lagarto-bg { position: absolute; right: -50px; bottom: -30px; width: 300px; opacity: 0.6; pointer-events: none; z-index: -1; }
        
        .btn-action { padding: 15px 30px; border-radius: 30px; font-weight: bold; cursor: pointer; border: none; margin: 10px; }
        .btn-reiniciar { background: #333; color: white; }
        .btn-colorear { background: white; color: black; }

        /* REUTILIZABLES */
        .btn-main { background: #2E7D32; color: white; padding: 15px; border-radius: 15px; border: none; width: 80%; margin: 10px; font-weight: bold; }
    </style>
</head>
<body>

<div id="s-setup" class="screen active">
    <h1>üïµÔ∏è‚Äç‚ôÇÔ∏è Registro de Agentes</h1>
    <input type="text" id="in-nombre" placeholder="Nombre..." style="padding:15px; border-radius:10px; width:80%;">
    <button class="btn-main" onclick="addJugador()">‚ûï A√ëADIR JUGADOR</button>
    <div id="lista-jug" style="display:flex; gap:10px; margin-top:20px;"></div>
    <button class="btn-main" id="btn-play" style="display:none; background:#B8860B;" onclick="finalizarJuego()">GENERAR PODIO FINAL üèÜ</button>
</div>

<div id="s-podio" class="screen">
    <h1 style="font-size: 2.5rem; color: #FFD700;">üèÜ PODIO DE JA√âN</h1>
    
    <div class="podio-container">
        <span style="position:absolute; right:10px; bottom:10px; font-size:15rem; opacity:0.3;">ü¶é</span>
        
        <div id="cards-render" style="display:flex; gap:15px; flex-wrap:wrap; justify-content:center; z-index:2;"></div>
    </div>

    <div style="margin-top: 30px;">
        <button class="btn-action btn-reiniciar" onclick="location.reload()">REINICIAR</button>
        <button class="btn-action btn-colorear">üñçÔ∏è COLOREAR</button>
    </div>

    <footer style="margin-top:auto; font-size: 0.8rem; border-top: 1px solid rgba(255,255,255,0.2); width:100%; padding:20px;">
        Proyecto Ciudades de Andaluc√≠a | Ja√©n ¬∑ Linares ¬∑ √öbeda ¬∑ Baeza ¬∑ And√∫jar ¬∑ Alcal√°
    </footer>
</div>

<script>
    let jugadores = [];
    const pueblosDefault = [
        ["Ja√©n", "Baeza"], ["√öbeda", "And√∫jar"], ["Linares", "Bail√©n"], ["Martos", "Alcal√°"]
    ];

    function addJugador() {
        const n = document.getElementById('in-nombre').value.toUpperCase();
        if(!n) return;
        
        // Crear avatar simple si no hay selfie (mantenemos l√≥gica anterior)
        const c = document.createElement('canvas'); c.width=200; c.height=200;
        const ctx = c.getContext('2d'); ctx.fillStyle = "#eee"; ctx.fillRect(0,0,200,200);
        ctx.font = "100px Arial"; ctx.textAlign="center"; ctx.fillText(n[0], 100, 130);

        jugadores.push({
            nombre: n,
            foto: c.toDataURL(),
            puntos: Math.floor(Math.random()*40),
            pueblos: pueblosDefault[jugadores.length % pueblosDefault.length]
        });

        document.getElementById('lista-jug').innerHTML += `<img src="${c.toDataURL()}" style="width:50px; border-radius:50%;">`;
        document.getElementById('in-nombre').value = "";
        if(jugadores.length >= 2) document.getElementById('btn-play').style.display="block";
    }

    function finalizarJuego() {
        mostrar('s-podio');
        const container = document.getElementById('cards-render');
        container.innerHTML = "";

        jugadores.sort((a,b) => b.puntos - a.puntos).forEach((j, index) => {
            let decoracion = "";
            let iconoExtra = "";
            
            // L√≥gica de personajes guardada
            if(j.nombre.includes("PE")) {
                decoracion = '<div class="rainbow-decor">üåà</div>';
                iconoExtra = '<span style="position:absolute; top:5px; left:5px;">üåà</span>';
            }
            if(j.nombre.includes("HACHE")) {
                iconoExtra = '<span style="position:absolute; top:5px; right:5px; font-size:1.5rem;">üëÆ</span>';
            }
            if(j.nombre.includes("JOTA")) {
                iconoExtra = '<span style="position:absolute; top:-15px; right:-10px; font-size:2rem;">üë®‚Äçüöí</span>';
            }

            container.innerHTML += `
                <div class="gold-card">
                    ${decoracion}
                    <div style="position:relative">
                        <img src="${j.foto}" class="photo-frame">
                        ${iconoExtra}
                    </div>
                    <div class="name-banner">${j.nombre}</div>
                    <div class="points-box">${j.puntos} PTS</div>
                    <div class="town-tags">
                        <div class="tag">${j.pueblos[0]}</div>
                        <div class="tag">${j.pueblos[1]}</div>
                    </div>
                </div>
            `;
        });
    }

    function mostrar(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }
</script>
</body>
</html>
